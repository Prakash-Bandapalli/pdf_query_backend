# PDF Question Answering - Backend (FastAPI)

This is the backend service for the PDF Question Answering application. It handles PDF uploads, text extraction, vector embedding generation using Google Generative AI, storage in Astra DB via CassIO, and provides an API endpoint for answering questions based on the document content using LangChain and Google Gemini.

## Features

* PDF document upload and processing.
* Text extraction from PDFs using PyMuPDF.
* Text chunking and vector embedding generation (Google Generative AI Embeddings).
* Vector storage and similarity search using Astra DB (Cassandra).
* Question answering using Google Gemini Pro via LangChain's RetrievalQA.
* CORS configured for interaction with the deployed frontend.

## Technologies Used

* **Framework:** FastAPI
* **Server:** Uvicorn
* **Language:** Python 3.11+
* **NLP/Vector Handling:** LangChain, Langchain-Google-Genai
* **Vector Database:** Astra DB (via CassIO library)
* **PDF Parsing:** PyMuPDF
* **Deployment:** Render (or your chosen platform)

## Prerequisites

* Python 3.11 or later
* pip (Python package installer)
* Git
* An [Astra DB](https://astra.datastax.com/) Serverless database instance.
* A Google API Key with access to Gemini Pro and Generative Language Embedding APIs (e.g., from [Google AI Studio](https://aistudio.google.com/)).

## Setup Instructions

1. **Clone the repository:**
   ```bash
   git clone [Your Repository URL]
   cd [Your Repository Folder]/pdf-qa-backend
   ```

2. **Create and activate a virtual environment:**
   ```bash
   # Windows
   python -m venv venv
   .\venv\Scripts\activate

   # macOS / Linux
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

## Environment Variables

Create a file named `.env` in the `pdf-qa-backend` root directory and add the following variables with your credentials. **This file is listed in `.gitignore` and should NOT be committed.**

```dotenv
# Google Gemini API Key
GOOGLE_API_KEY="YOUR_GOOGLE_AI_STUDIO_API_KEY"

# Astra DB Credentials
ASTRA_DB_APPLICATION_TOKEN="AstraCS:YOUR_TOKEN_STRING"
ASTRA_DB_ID="YOUR_DATABASE_ID"

# Astra DB Configuration (Must match table name used in config.py if not default)
ASTRA_DB_TABLE_NAME="pdftool_db" # Or your chosen table name
```

## Running Locally

1. Ensure your virtual environment is activated.

2. Make sure the `.env` file is created and populated.

3. Start the FastAPI development server using Uvicorn:
   ```bash
   uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
   ```
   * `--reload`: Enables auto-reload on code changes (for development).

4. Access the API documentation (Swagger UI) at: http://localhost:8000/docs

## API Endpoints

### POST /upload

**Description:** Uploads a PDF file for processing and indexing.

**Request:** multipart/form-data with a single field named `file` containing the PDF.

**Response (Success - 200 OK):**
```json
{
  "document_id": "unique-uuid-string",
  "filename": "uploaded_file_name.pdf",
  "message": "PDF processed and indexed successfully."
}
```

**Response (Error):** 4xx or 5xx status code with JSON `{"detail": "Error message"}`.

### POST /ask

**Description:** Asks a question about a previously uploaded document.

**Request:** application/json
```json
{
  "document_id": "unique-uuid-string-from-upload",
  "question": "Your question about the document content?"
}
```

**Response (Success - 200 OK):**
```json
{
  "document_id": "unique-uuid-string-from-upload",
  "question": "Your question about the document content?",
  "answer": "The answer generated by the LLM based on the document."
}
```
